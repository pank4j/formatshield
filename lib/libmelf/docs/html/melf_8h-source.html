<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>melf.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3-rc3 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="modules.html">Modules</a> &nbsp; <a class="qindex" href="annotated.html">Data Structures</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Data Fields</a> &nbsp; <a class="qindex" href="examples.html">Examples</a> &nbsp; </center>
<hr><h1>melf.h</h1><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment"> * uninformed research</span>
00003 <span class="comment"> * -------------------</span>
00004 <span class="comment"> *</span>
00005 <span class="comment"> * ELF manipulation library</span>
00006 <span class="comment"> *</span>
00007 <span class="comment"> * skape</span>
00008 <span class="comment"> * mmiller@hick.org</span>
00009 <span class="comment"> * 02/01/2003</span>
00010 <span class="comment"> */</span>
00025 <span class="preprocessor">#ifndef _MELF_H</span>
00026 <span class="preprocessor"></span><span class="preprocessor">#define _MELF_H</span>
00027 <span class="preprocessor"></span>
00028 <span class="preprocessor">#ifdef MELF_COMP</span>
00029 <span class="preprocessor"></span><span class="preprocessor">        #include "stdelf.h"</span>
00030 <span class="preprocessor">#else</span>
00031 <span class="preprocessor"></span><span class="preprocessor">        #include &lt;stdelf.h&gt;</span>
00032 <span class="preprocessor">#endif</span>
00033 <span class="preprocessor"></span>
00034 <span class="preprocessor">#define IS_OVERFLOW(melf, base, addr) ((melf)-&gt;imageSize &lt; ((unsigned long)(addr) - (unsigned long)(base)))</span>
00035 <span class="preprocessor"></span>
<a name="l00041"></a><a class="code" href="struct__elf__spec__header.html">00041</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__elf__spec__header.html">_elf_spec_header</a> {
00042 
<a name="l00046"></a><a class="code" href="struct__elf__spec__header.html#m0">00046</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>           <a class="code" href="struct__elf__spec__header.html#m0">index</a>;
<a name="l00050"></a><a class="code" href="struct__elf__spec__header.html#m1">00050</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>           <a class="code" href="struct__elf__spec__header.html#m1">identifier</a>;
00051 
00055         <span class="keyword">union</span>
00056 <span class="keyword">        </span>{
00057 
<a name="l00061"></a><a class="code" href="struct__elf__spec__header.html#m2">00061</a>                 Elf32_Shdr <a class="code" href="struct__elf__spec__header.html#m2">section</a>;
<a name="l00065"></a><a class="code" href="struct__elf__spec__header.html#m3">00065</a>                 Elf32_Phdr <a class="code" href="struct__elf__spec__header.html#m3">program</a>;
00066 
00067         } <a class="code" href="struct__elf__spec__header.html#m4">spec</a>;
00068 
<a name="l00072"></a><a class="code" href="struct__elf__spec__header.html#m5">00072</a>         <span class="keywordtype">void</span>                    *<a class="code" href="struct__elf__spec__header.html#m5">content</a>;
<a name="l00076"></a><a class="code" href="struct__elf__spec__header.html#m6">00076</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>           <a class="code" href="struct__elf__spec__header.html#m6">contentLength</a>;
00077 
<a name="l00081"></a><a class="code" href="struct__elf__spec__header.html#m7">00081</a>         <span class="keyword">struct </span><a class="code" href="struct__elf__spec__header.html">_elf_spec_header</a> *prev;
<a name="l00085"></a><a class="code" href="struct__elf__spec__header.html#m8">00085</a>         <span class="keyword">struct </span><a class="code" href="struct__elf__spec__header.html">_elf_spec_header</a> *next;
00086 
00087 } <a class="code" href="struct__elf__spec__header.html">ELF_SPEC_HEADER</a>;
00088 
<a name="l00094"></a><a class="code" href="struct__elf__spec__header__list.html">00094</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__elf__spec__header__list.html">_elf_spec_header_list</a> {
00095 
<a name="l00099"></a><a class="code" href="struct__elf__spec__header__list.html#m0">00099</a>         <a class="code" href="group__melf.html#a0">ELF_SPEC_HEADER</a> *<a class="code" href="struct__elf__spec__header__list.html#m0">head</a>;
<a name="l00103"></a><a class="code" href="struct__elf__spec__header__list.html#m1">00103</a>         <a class="code" href="group__melf.html#a0">ELF_SPEC_HEADER</a> *<a class="code" href="struct__elf__spec__header__list.html#m1">tail</a>;
00104 
<a name="l00108"></a><a class="code" href="struct__elf__spec__header__list.html#m2">00108</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>   <a class="code" href="struct__elf__spec__header__list.html#m2">seq</a>;
<a name="l00112"></a><a class="code" href="struct__elf__spec__header__list.html#m3">00112</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>   <a class="code" href="struct__elf__spec__header__list.html#m3">length</a>;
00113 
00114 } <a class="code" href="struct__elf__spec__header__list.html">ELF_SPEC_HEADER_LIST</a>;
00115 
<a name="l00121"></a><a class="code" href="struct__melf.html">00121</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__melf.html">_melf</a> {
00122 
<a name="l00126"></a><a class="code" href="struct__melf.html#m0">00126</a>         <span class="keywordtype">char</span>                 <a class="code" href="struct__melf.html#m0">image</a>[1024];
<a name="l00130"></a><a class="code" href="struct__melf.html#m1">00130</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>        <a class="code" href="struct__melf.html#m1">imageSize</a>;
00131 
<a name="l00135"></a><a class="code" href="struct__melf.html#m2">00135</a>         Elf32_Ehdr           <a class="code" href="struct__melf.html#m2">header</a>;
00136 
<a name="l00140"></a><a class="code" href="struct__melf.html#m3">00140</a>         <a class="code" href="struct__elf__spec__header__list.html">ELF_SPEC_HEADER_LIST</a> <a class="code" href="struct__melf.html#m3">sections</a>;
00141 
<a name="l00145"></a><a class="code" href="struct__melf.html#m4">00145</a>         <a class="code" href="struct__elf__spec__header__list.html">ELF_SPEC_HEADER_LIST</a> <a class="code" href="struct__melf.html#m4">programs</a>;
00146 
00147 } <a class="code" href="struct__melf.html">MELF</a>;
00148 
00154 <a class="code" href="struct__melf.html">MELF</a> *<a class="code" href="group__melf.html#a3">melf_new</a>();
00161 <a class="code" href="struct__melf.html">MELF</a> *<a class="code" href="group__melf.html#a4">melf_open</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *image);
00167 <span class="keywordtype">void</span> <a class="code" href="group__melf.html#a5">melf_destroy</a>(<a class="code" href="struct__melf.html">MELF</a> *melf);
00168 
00176 <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="group__melf.html#a6">melf_save</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, <span class="keyword">const</span> <span class="keywordtype">char</span> *path);
00177 
00182 <span class="comment">// Elf header functions</span>
00183 
00210 <span class="keywordtype">void</span> <a class="code" href="group__elfheader.html#a0">melf_elfSetType</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, Elf32_Half type);
00217 Elf32_Half <a class="code" href="group__elfheader.html#a1">melf_elfGetType</a>(<a class="code" href="struct__melf.html">MELF</a> *melf);
00218 
00225 <span class="keywordtype">void</span> <a class="code" href="group__elfheader.html#a2">melf_elfSetMachine</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, Elf32_Half machine);
00232 Elf32_Half <a class="code" href="group__elfheader.html#a3">melf_elfGetMachine</a>(<a class="code" href="struct__melf.html">MELF</a> *melf);
00233 
00240 <span class="keywordtype">void</span> <a class="code" href="group__elfheader.html#a4">melf_elfSetVersion</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, Elf32_Word version);
00247 Elf32_Word <a class="code" href="group__elfheader.html#a5">melf_elfGetVersion</a>(<a class="code" href="struct__melf.html">MELF</a> *melf);
00248 
00255 <span class="keywordtype">void</span> <a class="code" href="group__elfheader.html#a6">melf_elfSetEntry</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, Elf32_Addr entry);
00262 Elf32_Addr <a class="code" href="group__elfheader.html#a7">melf_elfGetEntry</a>(<a class="code" href="struct__melf.html">MELF</a> *melf);
00263 
00270 <span class="keywordtype">void</span> <a class="code" href="group__elfheader.html#a8">melf_elfSetProgramHeaderOffset</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, Elf32_Off offset);
00277 Elf32_Off <a class="code" href="group__elfheader.html#a9">melf_elfGetProgramHeaderOffset</a>(<a class="code" href="struct__melf.html">MELF</a> *melf);
00278 
00285 <span class="keywordtype">void</span> <a class="code" href="group__elfheader.html#a10">melf_elfSetSectionHeaderOffset</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, Elf32_Off offset);
00292 Elf32_Off <a class="code" href="group__elfheader.html#a11">melf_elfGetSectionHeaderOffset</a>(<a class="code" href="struct__melf.html">MELF</a> *melf);
00293 
00300 <span class="keywordtype">void</span> <a class="code" href="group__elfheader.html#a12">melf_elfSetProgramHeaderCount</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, Elf32_Half count);
00307 Elf32_Half <a class="code" href="group__elfheader.html#a13">melf_elfGetProgramHeaderCount</a>(<a class="code" href="struct__melf.html">MELF</a> *melf);
00308 
00315 <span class="keywordtype">void</span> <a class="code" href="group__elfheader.html#a14">melf_elfSetSectionHeaderCount</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, Elf32_Half count);
00322 Elf32_Half <a class="code" href="group__elfheader.html#a15">melf_elfGetSectionHeaderCount</a>(<a class="code" href="struct__melf.html">MELF</a> *melf);
00323 
00330 <span class="keywordtype">void</span> <a class="code" href="group__elfheader.html#a16">melf_elfSetStringTableIndex</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, Elf32_Half index);
00337 Elf32_Half <a class="code" href="group__elfheader.html#a17">melf_elfGetStringTableIndex</a>(<a class="code" href="struct__melf.html">MELF</a> *melf);
00338 
00343 <span class="comment">// Section functions</span>
00344 
00358 <a class="code" href="group__melf.html#a0">ELF_SPEC_HEADER</a> *<a class="code" href="group__sections.html#a0">melf_sectionAdd</a>(<a class="code" href="struct__melf.html">MELF</a> *melf);
00365 <a class="code" href="group__melf.html#a0">ELF_SPEC_HEADER</a> *<a class="code" href="group__sections.html#a1">melf_sectionGetEnum</a>(<a class="code" href="struct__melf.html">MELF</a> *melf);
00373 <a class="code" href="group__melf.html#a0">ELF_SPEC_HEADER</a> *<a class="code" href="group__sections.html#a2">melf_sectionEnumNext</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *en);
00381 <a class="code" href="group__melf.html#a0">ELF_SPEC_HEADER</a> *<a class="code" href="group__sections.html#a3">melf_sectionEnumPrev</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *en);
00382 
00390 <a class="code" href="group__melf.html#a0">ELF_SPEC_HEADER</a> *<a class="code" href="group__sections.html#a4">melf_sectionFindType</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> type);
00398 <a class="code" href="group__melf.html#a0">ELF_SPEC_HEADER</a> *<a class="code" href="group__sections.html#a5">melf_sectionFindIndex</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> index);
00406 <a class="code" href="group__melf.html#a0">ELF_SPEC_HEADER</a> *<a class="code" href="group__sections.html#a6">melf_sectionFindName</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, <span class="keyword">const</span> <span class="keywordtype">char</span> *name);
00407 
00416 <span class="keywordtype">void</span> <a class="code" href="group__sections.html#a7">melf_sectionSetContent</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *section, <span class="keywordtype">void</span> *content, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> contentLength);
00424 <span class="keywordtype">void</span> *<a class="code" href="group__sections.html#a8">melf_sectionGetContent</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *section);
00425 
00434 <span class="keywordtype">void</span> <a class="code" href="group__sections.html#a9">melf_sectionSetName</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *section, <span class="keyword">const</span> <span class="keywordtype">char</span> *name);
00442 <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__sections.html#a10">melf_sectionGetName</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *section);
00443 
00478 <span class="keywordtype">void</span> <a class="code" href="group__sections.html#a11">melf_sectionSetType</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *section, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> type);
00486 <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="group__sections.html#a12">melf_sectionGetType</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *section);
00487 
00495 <span class="keywordtype">void</span> <a class="code" href="group__sections.html#a13">melf_sectionSetAddress</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *section, Elf32_Addr addr);
00503 Elf32_Addr <a class="code" href="group__sections.html#a14">melf_sectionGetAddress</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *section);
00504 
00531 <span class="keywordtype">void</span> <a class="code" href="group__sections.html#a15">melf_sectionSetFlags</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *section, Elf32_Word flags);
00538 Elf32_Word <a class="code" href="group__sections.html#a16">melf_sectionGetFlags</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *section);
00539 
00547 <span class="keywordtype">void</span> <a class="code" href="group__sections.html#a17">melf_sectionSetEntrySize</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *section, Elf32_Word entsize);
00555 Elf32_Word <a class="code" href="group__sections.html#a18">melf_sectionGetEntrySize</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *section);
00556 
00564 <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="group__sections.html#a19">melf_sectionGetIndex</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *section);
00565 
00574 <span class="keywordtype">void</span> <a class="code" href="group__sections.html#a20">melf_sectionSetStringTableHeader</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *section, ELF_SPEC_HEADER *stringTable);
00582 <a class="code" href="group__melf.html#a0">ELF_SPEC_HEADER</a> *<a class="code" href="group__sections.html#a21">melf_sectionGetStringTableHeader</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *section);
00583 
00591 <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="group__sections.html#a22">melf_sectionRemove</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> id);
00592 
00610 <a class="code" href="group__melf.html#a0">ELF_SPEC_HEADER</a> *<a class="code" href="group__programs.html#a0">melf_programAdd</a>(<a class="code" href="struct__melf.html">MELF</a> *melf);
00617 <a class="code" href="group__melf.html#a0">ELF_SPEC_HEADER</a> *<a class="code" href="group__programs.html#a1">melf_programGetEnum</a>(<a class="code" href="struct__melf.html">MELF</a> *melf);
00625 <a class="code" href="group__melf.html#a0">ELF_SPEC_HEADER</a> *<a class="code" href="group__programs.html#a2">melf_programEnumNext</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *en);
00633 <a class="code" href="group__melf.html#a0">ELF_SPEC_HEADER</a> *<a class="code" href="group__programs.html#a3">melf_programEnumPrev</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *en);
00634 
00657 <span class="keywordtype">void</span> <a class="code" href="group__programs.html#a4">melf_programSetType</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *program, Elf32_Word type);
00665 Elf32_Word <a class="code" href="group__programs.html#a5">melf_programGetType</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *program);
00666 
00674 <span class="keywordtype">void</span> <a class="code" href="group__programs.html#a6">melf_programSetVirtualAddress</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *program, Elf32_Addr addr);
00682 Elf32_Addr <a class="code" href="group__programs.html#a7">melf_programGetVirtualAddress</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *program);
00683 
00691 <span class="keywordtype">void</span> <a class="code" href="group__programs.html#a8">melf_programSetPhysicalAddress</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *program, Elf32_Addr addr);
00699 Elf32_Addr <a class="code" href="group__programs.html#a9">melf_programGetPhysicalAddress</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *program);
00700 
00708 <span class="keywordtype">void</span> <a class="code" href="group__programs.html#a10">melf_programSetVirtualSize</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *program, Elf32_Word size);
00716 Elf32_Word <a class="code" href="group__programs.html#a11">melf_programGetVirtualSize</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *program);
00717 
00725 <span class="keywordtype">void</span> <a class="code" href="group__programs.html#a12">melf_programSetPhysicalSize</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *program, Elf32_Word size);
00733 Elf32_Word <a class="code" href="group__programs.html#a13">melf_programGetPhysicalSize</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *program);
00734 
00751 <span class="keywordtype">void</span> <a class="code" href="group__programs.html#a14">melf_programSetFlags</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *program, Elf32_Word flags);
00759 Elf32_Word <a class="code" href="group__programs.html#a15">melf_programGetFlags</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *program);
00760 
00768 <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="group__programs.html#a16">melf_programRemove</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> id);
00769 
00789 <a class="code" href="group__melf.html#a0">ELF_SPEC_HEADER</a> *<a class="code" href="group__sect__strings.html#a0">melf_stringTableCreate</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, <span class="keyword">const</span> <span class="keywordtype">char</span> *name);
00790 
00800 <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="group__sect__strings.html#a1">melf_stringTableSetString</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *stringTable, <span class="keyword">const</span> <span class="keywordtype">char</span> *name);
00809 <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__sect__strings.html#a2">melf_stringTableGetString</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *stringTable, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> index);
00810 
00828 <a class="code" href="group__melf.html#a0">ELF_SPEC_HEADER</a> *<a class="code" href="group__sect__dynamic.html#a0">melf_dynamicCreate</a>(<a class="code" href="struct__melf.html">MELF</a> *melf);
00829 
00892 Elf32_Dyn *<a class="code" href="group__sect__dynamic.html#a1">melf_dynamicAddTag</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *dynamic, Elf32_Sword tag, Elf32_Word val);
00901 <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="group__sect__dynamic.html#a2">melf_dynamicRemoveTag</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *dynamic, Elf32_Sword tag);
00910 <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="group__sect__dynamic.html#a3">melf_dynamicRemoveIndex</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *dynamic, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> index);
00919 Elf32_Dyn *<a class="code" href="group__sect__dynamic.html#a4">melf_dynamicGetTag</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *dynamic, Elf32_Sword tag);
00928 Elf32_Dyn *<a class="code" href="group__sect__dynamic.html#a5">melf_dynamicGetIndex</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *dynamic, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> index);
00938 <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="group__sect__dynamic.html#a6">melf_dynamicSetTag</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *dynamic, Elf32_Sword tag, Elf32_Word val);
00948 <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="group__sect__dynamic.html#a7">melf_dynamicSetIndex</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *dynamic, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> index, Elf32_Word val);
00949 
00969 <a class="code" href="group__melf.html#a0">ELF_SPEC_HEADER</a> *<a class="code" href="group__sect__note.html#a0">melf_noteCreate</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, <span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> createProgramHeader);
00970 
01017 Elf32_Nhdr *<a class="code" href="group__sect__note.html#a1">melf_noteAdd</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *note, Elf32_Word type, <span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *desc, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> descLength);
01026 Elf32_Nhdr *<a class="code" href="group__sect__note.html#a2">melf_noteEnum</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *note, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> index);
01035 <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="group__sect__note.html#a3">melf_noteRemove</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *note, Elf32_Nhdr *item);
01036 
01045 <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="group__sect__note.html#a4">melf_noteGetType</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *note, Elf32_Nhdr *item);
01053 <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__sect__note.html#a5">melf_noteGetName</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *note, Elf32_Nhdr *item);
01061 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="group__sect__note.html#a6">melf_noteGetDesc</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *note, Elf32_Nhdr *item);
01062 
01081 <a class="code" href="group__melf.html#a0">ELF_SPEC_HEADER</a> *<a class="code" href="group__sect__symboltable.html#a0">melf_symbolTableCreate</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, <span class="keyword">const</span> <span class="keywordtype">char</span> *name);
01082 
01090 Elf32_Sym *<a class="code" href="group__sect__symboltable.html#a1">melf_symbolTableAddSymbol</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *symTable, <span class="keyword">const</span> <span class="keywordtype">char</span> *name);
01099 Elf32_Sym *<a class="code" href="group__sect__symboltable.html#a2">melf_symbolTableEnum</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *symTable, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> index);
01108 <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="group__sect__symboltable.html#a3">melf_symbolTableRemoveSymbol</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *symTable, Elf32_Sym *symbol);
01109 
01129 <span class="keywordtype">void</span> <a class="code" href="group__sect__symbols.html#a0">melf_symbolSetName</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *symTable, Elf32_Sym *sym, <span class="keyword">const</span> <span class="keywordtype">char</span> *name);
01137 <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="group__sect__symbols.html#a1">melf_symbolGetName</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *symTable, Elf32_Sym *sym);
01138 
01147 <span class="keywordtype">void</span> <a class="code" href="group__sect__symbols.html#a2">melf_symbolSetValue</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *symTable, Elf32_Sym *sym, Elf32_Addr value);
01156 Elf32_Addr <a class="code" href="group__sect__symbols.html#a3">melf_symbolGetValue</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *symTable, Elf32_Sym *sym);
01157 
01166 <span class="keywordtype">void</span> <a class="code" href="group__sect__symbols.html#a4">melf_symbolSetSize</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *symTable, Elf32_Sym *sym, Elf32_Word size);
01175 Elf32_Word <a class="code" href="group__sect__symbols.html#a5">melf_symbolGetSize</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *symTable, Elf32_Sym *sym);
01176 
01194 <span class="keywordtype">void</span> <a class="code" href="group__sect__symbols.html#a6">melf_symbolSetBinding</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *symTable, Elf32_Sym *sym, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> binding);
01203 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="group__sect__symbols.html#a7">melf_symbolGetBinding</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *symTable, Elf32_Sym *sym);
01204 
01228 <span class="keywordtype">void</span> <a class="code" href="group__sect__symbols.html#a8">melf_symbolSetType</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *symTable, Elf32_Sym *sym, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> type);
01237 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="group__sect__symbols.html#a9">melf_symbolGetType</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *symTable, Elf32_Sym *sym);
01238 
01247 <span class="keywordtype">void</span> <a class="code" href="group__sect__symbols.html#a10">melf_symbolSetSectionIndex</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *symTable, Elf32_Sym *sym, Elf32_Half shndx);
01256 Elf32_Half <a class="code" href="group__sect__symbols.html#a11">melf_symbolGetSectionIndex</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *symTable, Elf32_Sym *sym);
01257 
<a name="l01274"></a><a class="code" href="group__elfres.html#a11">01274</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="group__elfres.html#a11">_Elf32_ResType</a> {
01278         <a class="code" href="group__elfres.html#a11a6">ELF_RES_TYPE_UNKNOWN</a> = 0,
01282         <a class="code" href="group__elfres.html#a11a7">ELF_RES_TYPE_STRING</a>  = 1,
01286         <a class="code" href="group__elfres.html#a11a8">ELF_RES_TYPE_BINARY</a>  = 2,
01287 } <a class="code" href="group__elfres.html#a0">Elf32_ResType</a>;
01288 
<a name="l01294"></a><a class="code" href="struct__Elf32__Res.html">01294</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__Elf32__Res.html">_Elf32_Res</a> {
01295 
01296         <span class="comment">// Stored on disk:</span>
01297         <span class="keyword">struct </span>_Elf32_Res_Header {
01298 
01302                 <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> length;
01306                 <a class="code" href="group__elfres.html#a0">Elf32_ResType</a> type;
01310                 <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> identifier;
01311         } header;
01312 
<a name="l01316"></a><a class="code" href="struct__Elf32__Res.html#m1">01316</a>         <span class="keywordtype">void</span>          *<a class="code" href="struct__Elf32__Res.html#m1">data</a>;    
01317 
01318         <span class="comment">// Not stored on disk, internal use only:</span>
<a name="l01322"></a><a class="code" href="struct__Elf32__Res.html#m2">01322</a> <span class="comment"></span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="struct__Elf32__Res.html#m2">index</a>;
<a name="l01326"></a><a class="code" href="struct__Elf32__Res.html#m3">01326</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="struct__Elf32__Res.html#m3">offset</a>;
01327 
01328 } <a class="code" href="struct__Elf32__Res.html">Elf32_Res</a>;
01329 
01336 <a class="code" href="group__melf.html#a0">ELF_SPEC_HEADER</a> *<a class="code" href="group__elfres.html#a2">melf_resOpen</a>(<a class="code" href="struct__melf.html">MELF</a> *melf);
01343 <a class="code" href="group__melf.html#a0">ELF_SPEC_HEADER</a> *<a class="code" href="group__elfres.html#a3">melf_resCreate</a>(<a class="code" href="struct__melf.html">MELF</a> *melf);
01353 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="group__elfres.html#a4">melf_resEnum</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *resTable, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> index, <a class="code" href="struct__Elf32__Res.html">Elf32_Res</a> *res);
01363 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="group__elfres.html#a5">melf_resGetType</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *resTable, Elf32_ResType type, <a class="code" href="struct__Elf32__Res.html">Elf32_Res</a> *res);
01373 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="group__elfres.html#a6">melf_resGetId</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *resTable, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> id, <a class="code" href="struct__Elf32__Res.html">Elf32_Res</a> *res);
01385 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="group__elfres.html#a7">melf_resAdd</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *resTable, Elf32_ResType type, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> length, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> id, <span class="keywordtype">void</span> *data);
01398 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="group__elfres.html#a8">melf_resUpdate</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *resTable, Elf32_ResType type, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> length, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> id, <span class="keywordtype">void</span> *data);
01407 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="group__elfres.html#a9">melf_resRemove</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *resTable, <a class="code" href="struct__Elf32__Res.html">Elf32_Res</a> *res);
01414 <span class="keywordtype">void</span> <a class="code" href="group__elfres.html#a10">melf_resClose</a>(<a class="code" href="struct__melf.html">MELF</a> *melf, ELF_SPEC_HEADER *resTable);
01415 
01420 <span class="preprocessor">#ifdef MELF_COMP</span>
01421 <span class="preprocessor"></span><span class="preprocessor">#include "melf_internal.h"</span>
01422 <span class="preprocessor">#endif</span>
01423 <span class="preprocessor"></span>
01424 <span class="preprocessor">#endif</span>
</pre></div><hr><address style="align: right;"><small>Generated on Tue Jun 3 00:01:35 2003 for libmelf by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.3-rc3 </small></address>
</body>
</html>
